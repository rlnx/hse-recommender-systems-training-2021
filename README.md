**Материалы лекции по рекомендательным системам для НН ВШЭ за декабрь 2021 года**

## Данные
Примеры построены на данных [Amazon Review (2018)][amazon_review]. Были отобраны пользователи и
товары с достаточно большим количеством отзывов. Всего в обучающую выборку вошло около 14K
пользователей и 50K товаров.

## Ноутбуки
### 1. ALS
Используется классический подход с применением разложения на матрице взаимодействий между
продуктами и пользователями. Используется библиотека [implicit][implicit] и вариация алгоритма
[ALS][als].

### 2. ALS + CatBoost
Демонстрируется подход с двухуровневой рекомендательной системой:
- Для начального отбора кандидатов используется ALS;
- Для ранжирования кандидатов применяется градиентный бустинг (CatBoost).

Построение фичей для стадии ранжирования основано на [классическом блендинге][blend]: скалярные
произведения между ALS-эмбеддингами пользователя и товара используются как фичи в градиентном
бустинге. Подробнее о подходе можно прочитать в [этой статье][tinkoff_rekko].

### 3. ALS + CatBoost + Feature Interaction
Попытка улучшить результаты градиентного бустинга за счёт включения взаимодействий между
бОльшим количеством признаков. С помощью ALS строятся эмбеддинги для различных матриц
взаимодействий: пользователь-товар, пользователь-категория, пользователь-бренд. Всевозможные
скалярные произведения таких эмбеддингов используются как признаки для градиентного бустинга.

Подход вдохновлён идеями, которые используются в архитектуре таких нейронных сетей как
[DeepFM][deepfm], [Neural Factorization Machine (NFM)][nfm] и прочих.

[amazon_review]: http://deepyeti.ucsd.edu/jianmo/amazon/index.html
[implicit]: https://implicit.readthedocs.io/en/latest
[als]: http://yifanhu.net/PUB/cf.pdf
[blend]: https://dyakonov.org/2017/03/10/c%D1%82%D0%B5%D0%BA%D0%B8%D0%BD%D0%B3-stacking-%D0%B8-%D0%B1%D0%BB%D0%B5%D0%BD%D0%B4%D0%B8%D0%BD%D0%B3-blending/
[tinkoff_rekko]: https://habr.com/ru/company/tinkoff/blog/454818
[deepfm]: https://arxiv.org/pdf/1703.04247.pdf
[nfm]: https://arxiv.org/pdf/1708.05027.pdf
